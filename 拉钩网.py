import requestsimport reimport timeimport jsonimport randomimport pandas as pdimport numpy as npimport matplotlib.pyplot as pltimport jiebafrom wordcloud import WordCloudimport matplotlib as mpl#coding:utf-8plt.rcParams['font.sans-serif']=['SimHei'] #用来正常显示中文标签plt.rcParams['axes.unicode_minus']=False #用来正常显示负号#有中文出现的情况，需要u'内容'from pyecharts import Geo#地址url = 'https://www.lagou.com/jobs/positionAjax.json?needAddtionalResult=false&isSchoolJob=0'#提交数据data = {    'first': 'true',    'pn': 1,    'kd': 'python'}#头部信息headers = {'Accept': 'application/json, text/javascript, */*; q=0.01','Accept-Encoding': 'gzip, deflate, br','Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8','Connection': 'keep-alive','Content-Length': '25','Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8','Cookie': 'JSESSIONID=ABAAABAAAIAACBICF2D484EF3B21916C06930C086122545; user_trace_token=20180305235659-d8510478-efa6-45dd-884c-d56decdd9279; _ga=GA1.2.1216929029.1520265420; LGUID=20180305235700-d70b4f43-208d-11e8-9d5c-525400f775ce; Hm_lvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1520265420,1520394912; LGSID=20180307115512-5640aad1-21bb-11e8-b12f-5254005c3644; PRE_UTM=; PRE_HOST=www.google.com; PRE_SITE=https%3A%2F%2Fwww.google.com%2F; PRE_LAND=https%3A%2F%2Fwww.lagou.com%2F; _gid=GA1.2.1461408367.1520394912; index_location_city=%E5%8C%97%E4%BA%AC; TG-TRACK-CODE=index_search; Hm_lpvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1520394933; LGRID=20180307115533-6284063b-21bb-11e8-9f71-525400f775ce; SEARCH_ID=5576cfd4890548a29a0de748299db022','Host': 'www.lagou.com','Origin': 'https://www.lagou.com','Referer': 'https://www.lagou.com/jobs/list_python?labelWords=&fromSearch=true&suginput=','User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36','X-Anit-Forge-Code': '0','X-Anit-Forge-Token': 'None','X-Requested-With': 'XMLHttpRequest'}#提交请求html = requests.post(url=url, data=data, headers=headers)html2 = html.textdata_list = json.loads(html.text)# print(data_list)# company = re.findall('"companyFullName":"(.*?)"', html2)data = re.findall('{"companyId":.*?,"score":.*?,"positionId":.*?,"positionName":"(.*?)","createTime":".*?","positionAdvantage":".*?","salary":"(.*?)","approve":.*?,"workYear":"(.*?)","education":"(.*?)","city":"(.*?)","companyLogo":".*?","jobNature":"(.*?)","industryField":".*?","companyShortName":"(.*?)",', html.text)# data = re.findall('{"companyId":.*?,"score":.*?,"positionId":.*?,"positionName":"(.*?)","createTime":".*?","positionAdvantage":"(.*?)","salary":"(.*?)","approve":1,"workYear":"(.*?)","education":"(.*?)","city":"(.*?)",,"companyLogo":".*?","jobNature":"全职","industryField":"移动互联网,教育","companyShortName":"(.*?)","financeStage":"C轮","companyLabelList":["产品领先行业","关注学习本源","明星跨界团队","股票期权"],"publisherId":7395094,"district":".*?","companySize":"150-500人","positionLables":[.*],"industryLables":[],"businessZones":["大山子","酒仙桥","望京","大山子","酒仙桥","望京","大山子","酒仙桥","望京"],"formatCreateTime":"1天前发布","longitude":"116.500139","latitude":"39.991999","companyFullName":"光合新知（北京）科技有限公司",',html.text)# data = json.loads(html)print(data)# 转换成数据框# data = pd.DataFrame(data)# data.to_csv(r'/Users/houzhimeng/Downloads/LaGouDataMatlab.csv', encoding='gbk')mpl.rcParams["font.sans-serif"] = ["Microsoft YaHei"]plt.rcParams["axes.labelsize"] = 16.plt.rcParams["xtick.labelsize"] = 14.plt.rcParams["ytick.labelsize"] = 14.plt.rcParams["legend.fontsize"] = 12.plt.rcParams["figure.figsize"] = [15., 15.]data = pd.read_csv('/Users/houzhimeng/Downloads/LaGouDataMatlab.csv', encoding='gbk')data.tail()data['学历'].value_counts().plot(kind='barh',rot=0)plt.show()# 导入数据# data.head()# print(data)# print(company)#记录cookie# html_cookie = html.cookies.get_dict()